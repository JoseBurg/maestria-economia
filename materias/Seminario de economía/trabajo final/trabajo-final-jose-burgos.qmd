---
title: "Determinantes de la asignación de inversiones en planes de pensión: evidencia de mujeres maduras en EE.UU."
format: pdf
editor: visual
---

```{r}
# Paquetes a utilizar:
#| echo: false
#| warning: false
#| message: false
library(tidyverse)

```

<!-- Información del estudio -->

Pregunta de investigación: ¿En qué medida los factores sociodemográficos y financieros explican la proporción invertida en acciones dentro de los planes de pensión?

Variable dependiente:

**pctstck**: Porcentaje invertido en acciones dentro del plan de pensión

Variables explicativas:

**educ**: Nivel educativo alcanzado

*wealth89*: Riqueza neta en 1989

**age**: Edad en años

**married**: Valor 1 si está casada

**irain89**: Valor 1 si tenía una cuenta IRA en 1989

Base de datos utilizada: pension

<!-- Lineamientps del análisis: -->

Introducción • Presenta el problema o fenómeno económico a estudiar. • Justifica su relevancia empírica o teórica. • Formula claramente la pregunta de investigación. • Expón de forma general tu hipótesis o lo que esperas encontrar. 2. Revisión de literatura • Resume brevemente estudios previos relevantes. • Enfócate en trabajos que hayan usado datos o modelos similares. • Identifica brechas que tu trabajo busca explorar. 1 • Usa citas correctamente en estilo APA. 3. Datos y metodología • Describe las fuentes de datos utilizadas y el período temporal. • Define cada variable (dependiente e independientes). • Presenta el modelo de regresión lineal múltiple propuesto (ecuación con notación formal). • Justifica la selección de variables. 4. Estimaciones y resultados • Presenta la tabla con resultados del modelo (coeficientes, errores estándar, R²). • Interpreta los coeficientes principales en términos económicos. • Comenta sobre la significancia estadística y sentido económico de los resultados. • No incluyas aquí especulaciones o recomendaciones (eso va en la conclusión). 5. Conclusiones • Resume los hallazgos principales y su coherencia con la literatura revisada. • Expón posibles implicaciones para políticas públicas o futuras investigaciones. • Señala limitaciones del análisis (si aplica).

<!-- Fin de lineamientos -->

```{r}
pension <- readxl::read_excel("pension.xlsx")
```

### Descripción de las variables

La variable dependiente es una variable continua que representa el porcentaje de acciones en el plan de pensión. Esta variable es una variable limitada entre 0 y 100, ya que no se puede invertir más del 100% en acciones. Esta variable es truncada o limitada y no tiene una distribución normal, lo que puede afectar la validez de los resultados del modelo de regresión lineal.

Los modelos tobit son adecuados para este tipo de variables, ya que permiten modelar la relación entre la variable dependiente y las variables independientes, teniendo en cuenta el truncamiento de la variable dependiente.

Las variables explicativas son: - **educ**: Variable categórica que representa el nivel educativo alcanzado por la persona. Esta variable puede tener un efecto significativo en la proporción de acciones en el plan de pensión, ya que las personas con mayor educación tienden a tener una mayor comprensión de los mercados financieros y, por lo tanto, pueden estar más dispuestas a invertir en acciones.

## Datos y metodología

Los datos utilizados en este estudio provienen de la base de datos pension, que contiene información sobre mujeres maduras en Estados Unidos. La base de datos incluye variables sociodemográficas y financieras, así como la proporción de acciones en el plan de pensión.

La variables de intereses son las siguientes:

-   **pctstck**: Porcentaje invertido en acciones dentro del plan de pensión (variable dependiente).

-   **educ**: Nivel educativo alcanzado (variable independiente).

-   **wealth89**: Riqueza neta en 1989 (variable independiente).

-   **age**: Edad en años (variable independiente).

-   **married**: Valor 1 si está casada (variable independiente).

-   **irain89**: Valor 1 si tenía una cuenta IRA en 1989 (variable independiente).

Deb

## Estimación del modelo de regresión lineal:

```{r}
#Variable dependiente:
summary(pension$pctstck)
modelo <- lm(pctstck ~ educ + wealth89 + age + married + irain89, data = pension)

stargazer::stargazer(modelo, type = "text", title = "Modelo de regresión lineal para pctstck")
```

#### Comprobando la normalidad de los residuos:

```{r}
# Histograma de los residuos
hist(residuals(modelo), main = "Histograma de los residuos", xlab = "Residuos", breaks = 20)
# QQ-plot de los residuos
qqnorm(residuals(modelo))
```

### Análisis de heterocedasticidad

Planteamiento de la hipótesis nula: La varianza de los errores es constante (homocedasticidad).

$$
H_0: Var(u_i) = σ^2 \quad \text{(homocedasticidad)}
$$

$$
H_a: Var(u_i) \neq σ^2 \quad \text{(heterocedasticidad)}
$$

```{r}
# Prueba de Breusch-Pagan
library(lmtest)
library(sandwich)
bptest(modelo)
# Prueba de White
white_test <- bptest(modelo, ~ fitted(modelo) + I(fitted(modelo)^2))
white_test
```

#### Prueba de Breusch-Pagan

El p-value es de 0.1711 lo que indica que no se rechaza la hipótesis nula de homocedasticidad. Concluyendo que al nivel de significancia del 5% no hay evidencia de heterocedasticidad en el modelo.

#### Prueba de White

En este test el p-value es de 0.1257 lo que también indica que no se rechaza la hipótesis nula de homocedasticidad. Por lo tanto, al igual que en la prueba de Breusch-Pagan, no hay evidencia de heterocedasticidad en el modelo.

### Análisis de multicolinealidad

Supuesto:

```{r}
# Matriz de correlación
cor_matrix <- cor(pension[, c("pctstck", "educ", "wealth89", "age", "married", "irain89")], use = "complete.obs")
# Visualización de la matriz de correlación
library(corrplot)
corrplot(cor_matrix, method = "circle", type = "upper", tl.col = "black", tl.srt = 45)
# VIF para detectar multicolinealidad
library(car)
vif_values <- vif(modelo)
vif_values
```

## Anexos:

Gráficos de las variables y validez de los resultados

```{r}
# plot(pension$ed)

```
